[{"/Users/jarvis/workspace/buffalo-client/src/index.tsx":"1","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/index.tsx":"2","/Users/jarvis/workspace/buffalo-client/src/reportWebVitals.ts":"3","/Users/jarvis/workspace/buffalo-client/src/util.ts":"4","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Tools.tsx":"5","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/MaterialList.tsx":"6","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Canvas.tsx":"7","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/ErrorBoundary.tsx":"8","/Users/jarvis/workspace/buffalo-client/src/store/index.ts":"9","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/PropsController.tsx":"10","/Users/jarvis/workspace/buffalo-client/src/widgets/styled.tsx":"11","/Users/jarvis/workspace/buffalo-client/src/store/editor/selectors.ts":"12","/Users/jarvis/workspace/buffalo-client/src/store/editor/initialState.ts":"13","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Content.tsx":"14","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Sider.tsx":"15","/Users/jarvis/workspace/buffalo-client/src/store/editor/editorSlice.tsx":"16","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/property-controls.ts":"17","/Users/jarvis/workspace/buffalo-client/src/store/editor/registerComponents.tsx":"18","/Users/jarvis/workspace/buffalo-client/src/widgets/Collapse.tsx":"19","/Users/jarvis/workspace/buffalo-client/src/widgets/ColorPicker.tsx":"20","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/PropEditorSwitcher.tsx":"21","/Users/jarvis/workspace/buffalo-client/src/widgets/NumberEditor.tsx":"22","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/CanvasBreadcrumb.tsx":"23","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/ComponentTree.tsx":"24","/Users/jarvis/workspace/buffalo-client/src/widgets/DisplayIcon.tsx":"25","/Users/jarvis/workspace/buffalo-client/src/widgets/SchemaForm.tsx":"26","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/SiderRight.tsx":"27","/Users/jarvis/workspace/buffalo-client/src/widgets/ModalSwitch.tsx":"28","/Users/jarvis/workspace/buffalo-client/src/widgets/withModal.tsx":"29","/Users/jarvis/workspace/buffalo-client/src/routes/index.tsx":"30","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Header.tsx":"31","/Users/jarvis/workspace/buffalo-client/src/pages/Home/index.tsx":"32"},{"size":911,"mtime":1636978695842,"results":"33","hashOfConfig":"34"},{"size":1417,"mtime":1637552752469,"results":"35","hashOfConfig":"34"},{"size":440,"mtime":1627443761534,"results":"36","hashOfConfig":"34"},{"size":133,"mtime":1614584714951,"results":"37","hashOfConfig":"34"},{"size":1893,"mtime":1637548571922,"results":"38","hashOfConfig":"34"},{"size":1800,"mtime":1636961201262,"results":"39","hashOfConfig":"34"},{"size":3807,"mtime":1629884888510,"results":"40","hashOfConfig":"34"},{"size":981,"mtime":1627443761526,"results":"41","hashOfConfig":"42"},{"size":966,"mtime":1637551535454,"results":"43","hashOfConfig":"34"},{"size":4530,"mtime":1636948055442,"results":"44","hashOfConfig":"34"},{"size":689,"mtime":1637549805160,"results":"45","hashOfConfig":"34"},{"size":792,"mtime":1628839633543,"results":"46","hashOfConfig":"34"},{"size":1135,"mtime":1637552676916,"results":"47","hashOfConfig":"34"},{"size":277,"mtime":1635842674157,"results":"48","hashOfConfig":"34"},{"size":307,"mtime":1636960809329,"results":"49","hashOfConfig":"34"},{"size":3909,"mtime":1637552750297,"results":"50","hashOfConfig":"34"},{"size":1368,"mtime":1634117235872,"results":"51","hashOfConfig":"34"},{"size":4076,"mtime":1636958424003,"results":"52","hashOfConfig":"34"},{"size":1045,"mtime":1627443761542,"results":"53","hashOfConfig":"42"},{"size":1184,"mtime":1627443761542,"results":"54","hashOfConfig":"34"},{"size":3280,"mtime":1629885624706,"results":"55","hashOfConfig":"34"},{"size":1189,"mtime":1627443761543,"results":"56","hashOfConfig":"34"},{"size":610,"mtime":1628843950857,"results":"57","hashOfConfig":"34"},{"size":1258,"mtime":1629079120318,"results":"58","hashOfConfig":"42"},{"size":238,"mtime":1629084132858,"results":"59","hashOfConfig":"42"},{"size":532,"mtime":1629880951069,"results":"60","hashOfConfig":"34"},{"size":208,"mtime":1636946136716,"results":"61","hashOfConfig":"34"},{"size":1143,"mtime":1636972136377,"results":"62","hashOfConfig":"34"},{"size":1831,"mtime":1636972127219,"results":"63","hashOfConfig":"34"},{"size":454,"mtime":1636979269933,"results":"64","hashOfConfig":"34"},{"size":1194,"mtime":1637552890144,"results":"65","hashOfConfig":"34"},{"size":81,"mtime":1636978635158,"results":"66","hashOfConfig":"34"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"69"},"153v89w",{"filePath":"70","messages":"71","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"72","messages":"73","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"76","messages":"77","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"78","messages":"79","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"80","messages":"81","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"82"},{"filePath":"83","messages":"84","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},"1jf3cfh",{"filePath":"86","messages":"87","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"88","messages":"89","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"90"},{"filePath":"91","messages":"92","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"93","messages":"94","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"95"},{"filePath":"96","messages":"97","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"98"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"101","messages":"102","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"103"},{"filePath":"104","messages":"105","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"106","messages":"107","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"108","messages":"109","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"110"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"121"},{"filePath":"122","messages":"123","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"124","messages":"125","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"85"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"128","messages":"129","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"130"},{"filePath":"131","messages":"132","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"133"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"136"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"139","messages":"140","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"141","messages":"142","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/jarvis/workspace/buffalo-client/src/index.tsx",[],["143","144"],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/index.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/reportWebVitals.ts",[],"/Users/jarvis/workspace/buffalo-client/src/util.ts",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Tools.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/MaterialList.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Canvas.tsx",["145"],"import classNames from \"classnames\";\r\nimport { isArray } from \"lodash\";\r\nimport React, {\r\n  ElementType,\r\n  FC,\r\n  PropsWithChildren,\r\n  useCallback,\r\n  useMemo,\r\n} from \"react\";\r\nimport toast from \"react-hot-toast\";\r\nimport { useAppDispatch, useAppSelector } from \"../../store\";\r\nimport {\r\n  addComponent,\r\n  cursorComponentBlur,\r\n  selectComponents,\r\n  selectCursorComponentId,\r\n  selectMaterials,\r\n  setCursorComponentId,\r\n} from \"../../store/editor/editorSlice\";\r\nimport { componentMap } from \"../../store/editor/registerComponents\";\r\nimport { CanvasComponent } from \"../../types\";\r\nimport ErrorBoundary from \"./ErrorBoundary\";\r\n\r\nconst ComponentWrap: FC<PropsWithChildren<{\r\n  canvasComponent: CanvasComponent;\r\n}>> = ({ children, canvasComponent }) => {\r\n  const dispatch = useAppDispatch();\r\n  const cursorComponentId = useAppSelector(selectCursorComponentId);\r\n\r\n  const handleClick = useCallback(\r\n    (e: React.MouseEvent) => {\r\n      e.stopPropagation();\r\n      dispatch(setCursorComponentId(canvasComponent.id));\r\n    },\r\n    [canvasComponent.id, dispatch]\r\n  );\r\n\r\n  const isActive = useMemo(() => {\r\n    return canvasComponent.id === cursorComponentId;\r\n  }, [canvasComponent.id, cursorComponentId]);\r\n\r\n  // Note: 需要这个才能触发 onDrop\r\n  const handleDragOver = (e: React.DragEvent<HTMLElement>) => {\r\n    e.preventDefault();\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent<HTMLElement>) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    debugger;\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={classNames(\"ComponentWrap\", { active: isActive })}\r\n      onClick={handleClick}\r\n      onDragOver={handleDragOver}\r\n      onDrop={handleDrop}\r\n    >\r\n      {children}\r\n      <div className=\"TopLeftDot ResizeDot\" />\r\n      <div className=\"TopRightDot ResizeDot\" />\r\n      <div className=\"BottomLeftDot ResizeDot\" />\r\n      <div className=\"BottomRightDot ResizeDot\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Canvas = () => {\r\n  const materials = useAppSelector(selectMaterials);\r\n  const components = useAppSelector(selectComponents);\r\n  const cursorComponentId = useAppSelector(selectCursorComponentId);\r\n  const dispatch = useAppDispatch();\r\n\r\n  const handleDrop = (e: React.DragEvent<HTMLElement>) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const materialId = e.dataTransfer.getData(\"material\");\r\n    const material = materials.filter((m) => m.id === materialId)[0];\r\n    if (material) {\r\n      dispatch(addComponent(material));\r\n      toast.success(`添加物料成功: ${material.zhName}`);\r\n    } else {\r\n      toast.error(\"没有找到物料\");\r\n    }\r\n  };\r\n\r\n  // Note: 需要这个才能触发 onDrop\r\n  const handleDragOver = (e: React.DragEvent<HTMLElement>) => {\r\n    e.preventDefault();\r\n  };\r\n\r\n  const unsetCursor = useCallback(() => {\r\n    if (cursorComponentId) {\r\n      // dispatch(cursorComponentBlur());\r\n    }\r\n  }, [cursorComponentId]);\r\n\r\n  const renderComponents = (components: CanvasComponent[]) => {\r\n    return components.map((c) => {\r\n      const ComponentType = componentMap.get(c.materialId) as ElementType;\r\n      let children: any = c.props.children; // TODO: fix type\r\n      if (isArray(children)) {\r\n        children = <>{renderComponents(children)}</>;\r\n      }\r\n      return (\r\n        <ComponentWrap key={c.id} canvasComponent={c}>\r\n          <ErrorBoundary>\r\n            {ComponentType && (\r\n              <ComponentType {...c.props} children={children} />\r\n            )}\r\n          </ErrorBoundary>\r\n        </ComponentWrap>\r\n      );\r\n    });\r\n  };\r\n\r\n  return (\r\n    <section\r\n      className=\"Canvas\"\r\n      onDrop={handleDrop}\r\n      onDragOver={handleDragOver}\r\n      onClick={unsetCursor}\r\n    >\r\n      <ErrorBoundary>{renderComponents(components)}</ErrorBoundary>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Canvas;\r\n","/Users/jarvis/workspace/buffalo-client/src/pages/Editor/ErrorBoundary.tsx",[],["146","147"],"/Users/jarvis/workspace/buffalo-client/src/store/index.ts",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/PropsController.tsx",[],["148","149"],"/Users/jarvis/workspace/buffalo-client/src/widgets/styled.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/store/editor/selectors.ts",[],["150","151"],"/Users/jarvis/workspace/buffalo-client/src/store/editor/initialState.ts",[],["152","153"],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Content.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Sider.tsx",[],["154","155"],"/Users/jarvis/workspace/buffalo-client/src/store/editor/editorSlice.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/property-controls.ts",[],"/Users/jarvis/workspace/buffalo-client/src/store/editor/registerComponents.tsx",[],["156","157"],"/Users/jarvis/workspace/buffalo-client/src/widgets/Collapse.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/widgets/ColorPicker.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/PropEditorSwitcher.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/widgets/NumberEditor.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/CanvasBreadcrumb.tsx",[],["158","159"],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/ComponentTree.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/widgets/DisplayIcon.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/widgets/SchemaForm.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/SiderRight.tsx",[],["160","161"],"/Users/jarvis/workspace/buffalo-client/src/widgets/ModalSwitch.tsx",[],["162","163"],"/Users/jarvis/workspace/buffalo-client/src/widgets/withModal.tsx",[],["164","165"],"/Users/jarvis/workspace/buffalo-client/src/routes/index.tsx",[],"/Users/jarvis/workspace/buffalo-client/src/pages/Editor/Header.tsx",["166"],"/Users/jarvis/workspace/buffalo-client/src/pages/Home/index.tsx",[],{"ruleId":"167","replacedBy":"168"},{"ruleId":"169","replacedBy":"170"},{"ruleId":"171","severity":1,"message":"172","line":14,"column":3,"nodeType":"173","messageId":"174","endLine":14,"endColumn":22},{"ruleId":"167","replacedBy":"175"},{"ruleId":"169","replacedBy":"176"},{"ruleId":"167","replacedBy":"177"},{"ruleId":"169","replacedBy":"178"},{"ruleId":"167","replacedBy":"179"},{"ruleId":"169","replacedBy":"180"},{"ruleId":"167","replacedBy":"181"},{"ruleId":"169","replacedBy":"182"},{"ruleId":"167","replacedBy":"183"},{"ruleId":"169","replacedBy":"184"},{"ruleId":"167","replacedBy":"185"},{"ruleId":"169","replacedBy":"186"},{"ruleId":"167","replacedBy":"187"},{"ruleId":"169","replacedBy":"188"},{"ruleId":"167","replacedBy":"189"},{"ruleId":"169","replacedBy":"190"},{"ruleId":"167","replacedBy":"191"},{"ruleId":"169","replacedBy":"192"},{"ruleId":"167","replacedBy":"193"},{"ruleId":"169","replacedBy":"194"},{"ruleId":"171","severity":1,"message":"195","line":4,"column":10,"nodeType":"173","messageId":"174","endLine":4,"endColumn":21},"no-native-reassign",["196"],"no-negated-in-lhs",["197"],"@typescript-eslint/no-unused-vars","'cursorComponentBlur' is defined but never used.","Identifier","unusedVar",["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],["196"],["197"],"'useSelector' is defined but never used.","no-global-assign","no-unsafe-negation"]